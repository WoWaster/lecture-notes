% !TeX root = ./main.tex
\documentclass[main]{subfiles}
\begin{document}


\chapter{Инвариантные подпространства}

\begin{definition}
   $V$ — линейное конечномерное пространство, $A\in \End \ V$. Пусть $W\subset \ V$ — линейное подпространство. 
   $W$ — называется инвариантным относительно $A$, если $\forall w\in W : \mca(w) \in W$.
\end{definition}

\begin{propertylist} 
    \
    \begin{enumerate}
        \item $0, W$ — $A$-инвариантны
        \item $\Ker \mca$ — $A$-инвариантно
        \item $\Im \mca$ — $A$-инвариантен
    \end{enumerate}
\end{propertylist}
    


Пусть $W$ — $A$-инвариант. Следовательно, $A|_W$ можно рассматривать как элемент $\End \ W$. 
Более формально, $\exists\  \mca_1 \in \End \ W \ \forall w \in W : \mca_1 w=\mca w$
\[W\xrightarrow{\mca} W \quad w\mapsto \mca w\]

$\mca_1$  —  оператор индуцированный оператором $\mca$ на инвариантном подпространстве $W$.

$Пусть W\subset V,\ V/W = \{ v+w |v \in V\}$ — фактор-пространство.  $W$ — $A$-инвариант.
Определим $\mca_2$.

\[\mca_2: V/W \rightarrow V/W \quad v+W \mapsto \mca v+W\]

Проверка корректности: пусть $v_1+W = v_2+W$, нужно проверить, что $\mca v_1+W=\mca v_2 + W$. Так, $\mca v_2= \mca(v_1+(v_2-v_1))=\mca v_1+ \mca\underbrace{(v_2-v_1)}_{\in W} \Rightarrow
 \mca v_2 + W= \mca v_1+W$.

\begin{proposition} {}
$\mca_2 \in \End \ V/W$
\end{proposition}

\begin{proof}
    Проверка линейности:
    \begin{multline*}
        \mca_2((v_1+W)+(v_2+W))= \mca_2((v_1+v_2)+W)=\\
        \mca(v_1+v_2)+W=  \mca v_1+\mca v_2+W=\\
        (\mca v_1+W)+(\mca v_2+W)
    \end{multline*}
    \begin{multline*}
        \mca_2(\alpha(v+w))= \mca_2(\alpha v+W)=\\
        \mca(\alpha v)+W= \alpha \mca v +W=\\
        \alpha(\mca v +W) = \alpha \mca_2(v+W)
    \end{multline*}
\end{proof}

$\mca_2$ — индуцированный оператор на фактор-пространстве.

\begin{proposition} {}
Пусть $\mca \in \End \ V, W \subset V, e_1, \ldots ,e_m$ — базис $W$, $e_{m+1}, \ldots ,e_n$ — дополнение до базиса $V$. Тогда эквивалентны 2 утверждения:

\begin{enumerate}
    \item $W$ — $A$-инвариант
    \item $[\mca]_{e_1, \ldots ,e_n}$ = $\left(
        \begin{tabular}{c|c}
            $A_1$ & $B$     \\
            \hline
            0   & $A_2$          \\         
        \end{tabular}
    \right), \ A_1 \in M_m(K)$
\end{enumerate}

При этом $A_1=[\mca_1]_{e_1, \ldots ,e_m}, \ A_2=[\mca_2]_{e_{m+1}+W,\ldots ,e_n+W }$, где $\mca_1$ и $\mca_2$ — соответствующие индуцированные операторы.
\end{proposition}

\begin{proof}
$1 \Rightarrow 2$:
векторы $e_1, \ldots ,e_n \in W \Rightarrow \ \mca e_1, \ldots ,\mca e_m \in W = \Lin(e_1, \ldots ,e_m) \Rightarrow [\mca]_{e_1, \ldots ,e_n} = \left(
\begin{tabular}{c|c}
            $A_1$ & $B$     \\
            \hline
            0   & $A_2$          \\         
        \end{tabular}
\right)$

Очевидно, $[\mca_1]_{e_1, \ldots e_m} =A_1$. 

Пусть $[\mca]_{e_1, \ldots ,e_n} = (a_{ij})$.

$\mca e_j = \underbrace{a_{1j}e_1+\ldots + a_{mj}e_m}_{\in W}+a_{m+1j}e_{m+1}+\ldots + a_{nj}e_n$, $j \geqslant m+1$

$\underbrace{\mca e_j + W}_{=\mca_2(e_j+W)} = \underbrace{a_{m+1j}e_{m+1}+\ldots+a_{nj}e_n+W}_{=a_{m+1j}(e_{m+1}+W)+\ldots+a_{nj}(e_n+W)}$ (первые $m$ элементов станут нулевым классом). 
Таким образом, $[\mca_2]_{e_{m+1}+W, \ldots, e_n+W} =
\begin{pmatrix}
    a_{m+1m+1} & \ldots & a_{m+1n} \\
    \vdots     & \ddots & \vdots   \\
    a_{nm+1}   & \ldots & a_{nn}   \\
\end{pmatrix}
= A_2$


$2 \Rightarrow 1$:
$[\mca_1]_{e_1, \ldots ,e_n} = \left(\begin{array}{c|c}
            A_1 & B   \\ \hline
            0   & A_2 \\
        \end{array}\right)
    \Rightarrow \mca e_1,\ldots,\mca e_m \in \Lin(e_1,\ldots ,e_m) \in W$.
    Пусть $w\in W \Rightarrow w=\beta_1e_1+\ldots+\beta_me_m \Rightarrow \mca w= \beta_1\underbrace{\mca_1e_1}_{\in W}+\ldots+\beta_m\underbrace{\mca_me_m}_{\in W}\in W$.
\end{proof} 

Итак, мы выяснили, что если в нашем подпространсве $V$ есть инвариантное подпространство меньшей размерности (ненулевое) 
$W \subset V$, то это позволяет нам составить блочно-треугольную матрицу
$\left(\begin{array}{c|c}
    A_1 & B   \\ \hline
    0   & A_2 \\
\end{array}\right)$, где $A_1,\ A_2$ - квадратные матрицы, $\A_1 \in M_m(K),\ m = \dim W$. \marginpar{14.09.22}

В ситуации $V = W_1 \bigoplus W_2$, можно получить $\left(\begin{array}{c|c}
    A_1 & 0   \\ \hline
    0   & A_2 \\
\end{array}\right)$.

\begin{proposition} 
    Пусть $\mca \in \End V,\ V=W_1 \bigoplus W_2,\ 
    \underbrace{e_1, \ldots , e_m}_{E_1}$
    — базис $W_1$, $\underbrace{e_{m+1}, \ldots , e_{n}}_{E_2}$
    — базис $W_2$, $E = E_1+E_2$. Тогда эквивалентны 2 утверждения:
    \begin{enumerate}
        \item $ W_1, W_2 - \mca $-инвариантны
        \item $[\mca]_E = \left(\begin{array}{c|c}
            A_1 &   0  \\
            \hline
            0   & A_2  \\         
        \end{array}\right),\ A_1 \in M_m(K),\ A_2 \in M_{n-m}(K)$.
        При этом $A_1 = [\mca|_{W_1}]_{E_1},\ A_2 = [\mca|_{W_2}]_{E_2}$
    \end{enumerate}
\end{proposition}

\begin{proof}
    Аналогично предыдущему предположению. 
    $1 \Rightarrow 2$: 
    $\mca e_1, \ldots, \mca e_m \in W_1 \Rightarrow$ $\left(\begin{array}{c|c}
    A_1 &    \\
       \hline
    0   &         \\         
    \end{array}\right)$,\
    $\mca e_{m+1}, \ldots, \mca e_n \in W_2 \Rightarrow$ $\left(\begin{array}{c|c}
         &  0  \\
       \hline
       &   A_2      \\         
    \end{array}\right) $.

    $2\Rightarrow 1$: 
    $\left(\begin{array}{c|c}
     &    \\
       \hline
    0   &         \\         
    \end{array}\right) $ $\Rightarrow \mca e_1, \ldots, \mca e_m \in \Lin(e_1, \ldots, e_m) = W_1
    \Rightarrow \forall w \in W_1,\ \mca w \in W_1,\ W_1$ — $A$-инвариант.

    $\left(\begin{array}{c|c}
        &   0 \\
          \hline
        &     \\         
       \end{array}\right) $ $\Rightarrow \mca e_{m+1}, \ldots, \mca e_n \in \Lin(e_{m+1}, \ldots, e_n) = W_2
       \Rightarrow \forall w \in W_2,\ \mca w \in W_2,\ W_2$ — $A$-инвариант.
\end{proof}

Что означает в терминах оператора, что матрица получилась диагональной? Например, образ первого базисного вектора будет 
прямо пропорционален первому базисному вектору: $\mca e_1 = \lambda_1 e_1,\ \mca e_2 = \lambda_2 e_2$ и т.д.
 \end{document}