% !TeX root = ./main.tex
\documentclass[main]{subfiles}
\begin{document}
\chapter{Теория меры}
\section{Мера и интеграл Лебега. Построение меры Лебега}\marginpar{20.04.23}
\begin{definition}
    Непустое множество $R$, элементами которого являются множества, называется кольцом, если $A, B \in \calR \implies A \cup B \in \calR$, $A \setminus B \in \calR$.
    В частности, $\varnothing = A \setminus A \in \calR$, $A \cap B = A \setminus (A \setminus B) \in \calR$.
\end{definition}

\begin{definition}
    Кольцо $\calR$ называется $\sigma$-кольцом, если $A_n \in \calR$, $n \in \N \implies \bigcup_{n=1}^{\infty} A_n \in \calR$.
    При этом, если $\calR$~--- $\sigma$-кольцо, то $\bigcap_{n=1}^{\infty} A_n = A_1 \setminus \bigcup_{n=1}^{\infty} (A_1\setminus A_n) \in \calR$.
\end{definition}

\begin{definition}
    Если $\calR$~--- кольцо, $\phi: \calR \to \R \cup \{-\infty\} \cup \{+\infty\}$~--- функция (отображение), то $\phi$ называется аддитивной, если $A, B\in \calR,$ $A \cap B = \varnothing \implies \phi(A \cup B) = \phi(A) + \phi(B)$.
\end{definition}

\begin{definition}
    Функция $\phi$ называется счётно-аддитивной, если из $A_n \in \calR,$ $n \in \N$, $\bigcup_{n=1}^{\infty} A_n \in \calR$, $A_j \cap A_k = \varnothing$, если $j \neq k$, $j, k \in \N \implies \phi(\bigcup_{n=1}^{\infty} A_n) = \sum_{n=1}^{\infty} \phi(A_n)$.
\end{definition}

\subsection{Свойства аддитивных функций}
\begin{enumerate}
    \item $\varnothing \cup \varnothing = \varnothing$, $\varnothing \cap \varnothing = \varnothing \implies \phi(\varnothing) = \phi(\varnothing \cup \varnothing) = \phi(\varnothing) + \phi(\varnothing) \implies \phi(\varnothing) = 0$;
    \item Если $A_j \cap A_k = \varnothing$, $j \neq k$, $1\le j, k\le n \implies \phi(\bigcup_{j=1}^{n} A_j) = \sum_{j=1}^n \phi(A_j)$, доказывается по индукции;
    \item $A, B \in \calR, A \setminus B = A \setminus (A \cap B) \implies$
          \[A = (A \setminus (A \cap B)) \cup (A \cap B) \implies \phi(A) = \phi(A \setminus (A \cap B)) + \phi(A \cap B),\]
          аналогично $\phi(B) = \phi(B \setminus (A \cap B)) + \phi(A \cap B)$
          \begin{multline*}
              \phi(A) + \phi(B) = \\
              = (\phi(A \setminus (A \cap B)) + \phi(B \setminus (A \cap B)) + \phi(A \cap B)) + \phi(A \cap B) = \\
              = \phi(A \cup B) + \phi(A \cap B),
          \end{multline*}
          т.к. $(A \setminus (A \cap B)) \cup (B \setminus (A \cap B)) \cup (A \cap B) = A \cup B$;
    \item Если $\phi(A) \ge 0\ \forall A \in \calR$, $A \subset B$, то $\phi(A) \le \phi(B)$ т.к. $B = A \cup (B \setminus A)$, $\phi(B) = \phi(A) + \phi(B \setminus A) \ge \phi(A)$
\end{enumerate}

\begin{theorem}
    Пусть $\phi$~--- счётно-аддитивная функция на кольце $\calR$, пусть $A_1 \subset A_2 \subset \dots \subset A_n \subset \dots$, $A = \bigcup_{n=1}^{\infty} A_n$, пусть $A_n\in\calR\ \forall n$ и $A\in\calR$.
    Тогда
    \[\phi(A_n)\xrightarrow[n\to\infty]{} \phi(A).\]
\end{theorem}

\begin{proof}
    Пусть $B_1=A_1$, $B_n=A_n\setminus A_{n-1}$, $n\ge 2$.

    Тогда $B_j\cap B_k=\varnothing$, $j\neq k$, $A_n = \bigcup_{j=1}^n B_j$, $A = \bigcup_{j=1}^\infty B_j$.

    Тогда $\phi(A_n)=\sum_{j=1}^n \phi(B_j)$, $\phi(A)=\sum_{j=1}^{\infty}\phi(B_j)$, откуда и следует утверждение теоремы.
\end{proof}

\begin{definition}
    Промежутком $\mr{a,b}$, где $a\in\R^m$, $ b\in\R^m$ будем называть множество
    \[\mr{a,b} = \{x = (x_1,\dotsc,x_m): x_j \in \mr{a_j, b_j}, 1 \le j \le m\},\]
    где знак $\mr{,}$ может независимо принимать значения $(,[,),]$.
\end{definition}

\begin{definition}
    Элементарным множеством будем называть объединение конечного числа промежутков $\mr{a_j,b_j}$.
\end{definition}

\begin{definition}
    Для промежутка $\mr{a,b}$ его мерой $m(\mr{a,b})$ назовём выражение
    \[ m(\mr{a,b})=\prod_{j=1}^{m}(b_j-a_j)\tag{1} \]
\end{definition}

\begin{remark}
    Всегда полагаем $a_j\le b_j$, возможность $a_j=b_j$ допускаем, если $\langle=(, \rangle = )$ в $j$ и $a_j=b_j$, то $\mr{a,b}=\varnothing$, поэтому (1) $\implies m(\varnothing)=0$.
\end{remark}

\begin{remark}
    Если $A = \bigcup_{j=1}^n I_j$, $I_j$~--- промежутки, $I_j \cap I_k=\varnothing$, если $j\neq k$, то полагаем
    \[ m\,A=\sum_{j=1}^n m\,I_j\tag{2} \]
\end{remark}

\begin{theorem}
    Пусть $\mathcal{E}$~--- множество элементарных множеств в $\R^m$.
    Тогда $\mathcal{E}$~--- кольцо, но не $\sigma$-кольцо; если $A\in\mathcal{E}$, то $\exists\,I_j-$ промежутки, $1\le j\le n$, $n$ зависит от $A$ т.ч. $I_j\cap I_k=\varnothing$ и $A=\bigcup_{j=1}^n I_j$; если $A\in\mathcal{E}$, $ A=\bigcup_{k=1}^l I'_k$, $I'_k$~--- промежуток, $I'_k\cap I'_q=\varnothing$, то
    \[ \sum_{k=1}^l m\,I_k'=\sum_{j=1}^n m\,I_j \]
\end{theorem}

\begin{proof}
    Примем без доказательства.
    Случай $m=1$ доказать самостоятельно.
\end{proof}

\begin{definition}
    Через $(a,b)$ будем обозначать множество
    \[\{ x=(x_1,\dotsc,x_m)\in\R^m: a_j<x_j<b_j, 1\le j\le m\},\]
    открытым элементарным множеством будем называть объединение конечного числа промежутков $(a,b)$.
\end{definition}

\begin{definition}
    Пусть $E\subset\R^n$~--- произвольное множество.
    Через $U(E)$ будем обозначать множество конечных или счётных множеств открытых элементарных множеств $\{A_n\}^\infty_{n=1}$ таких, что $E\subset\bigcup_{n=1}^{\infty} A_n$ (объединение может быть конечным).
\end{definition}

\begin{definition}
    Внешней мерой множества $E$ $m^*E$ назовём величину
    \[ m^*E \coloneq \inf_{\{A_n\}^\infty_{n=1}\in U(E)} \sum_{n=1}^{\infty} m\,A_n\tag{3} \]
    $(3) \implies m^*E\ge 0\ \forall E$, если $E_1\subset E_2\implies m^*E_1\le m^*E_2$, т.к. $U(E_2)\subset U(E_1)$.
\end{definition}

\begin{theorem}[полуаддитивность внешней меры]
    Пусть $E=\bigcup_{n=1}^{\infty} E_n$, тогда \[m^*E\le\sum_{n=1}^{\infty} m^*E_n\tag{4}\]
\end{theorem}

\begin{proof}
    Предположим, что $m^*E_n<+\infty\ \forall n$, поскольку иначе (4) выполнено.
    Выберем $\forall\epsilon>0$, для $n\in\N$ пусть $\{A_{n_k}\}^\infty_{k=1}\in U(E_n)$ и
    \[ \sum_{k=1}^{\infty} m\,A_{n_k}< m^*E_n+\frac{\epsilon}{2^n}\tag{5} \]
    Тогда $\bigcup_{n=1}^{\infty} \bigcup_{k=1}^\infty A_{n_k}\in U(E)$, тогда (5) $\implies$
    \[ m^*E\le\sum_{n=1}^{\infty} \left( \sum_{k=1}^{\infty} m\,A_{n_k} \right) < \sum_{n=1}^{\infty} \left(m^*E_n+\frac{\epsilon}{2^n}\right) = \sum_{n=1}^{\infty} m^*E_n+\epsilon\tag{6} \]
    Поскольку $\epsilon>0$ произвольно, то $(6)\implies (4)$.
\end{proof}

\begin{lemma}[Бореля]
    Пусть $K\subset\R^m$~--- компакт, $A_n$, $n=1, 2, \dots$~--- открытые множества, и $K\subset\bigcup_{n=1}^{\infty} A_n$.
    Тогда $\exists\,A_{n_1}, \dots,A_{n_k}$ т.ч. $K\subset \bigcup_{j=1}^k A_{n_j}$
\end{lemma}

\begin{proof}
    Примем без доказательства.
\end{proof}

\section{Свойства внешней меры элементарных множеств}
\begin{theorem}
    Пусть $A$~--- элементарное множество.
    Тогда $m^*A=m\,A$.
\end{theorem}

\begin{longProof}
    Достаточно рассмотреть случай $A=\mr{a,b}$.
    Возьмём $\forall \delta>0$, положим
    \[\mr{a,b}_\delta\coloneq\{x=(x_1,\dotsc,x_m): x_j\in(a_j-\delta, b_j+\delta)\}.\]
    Тогда $\mr{a,b}_\delta$~--- открытое элементарное множество, $\mr{a,b}\subset\mr{a,b}_\delta$, $ m(\mr{a,b}_\delta) \xrightarrow[\delta \to +0]{} m(\mr{a,b})$, поэтому можно взять такое $\epsilon>0$, что $m(\mr{a,b}_\delta)<m(\mr{a,b})+\epsilon$, т.е.
    \[m^*(\mr{a,b})\le m(\mr{a,b}_\delta)<m(\mr{a,b})+\epsilon,\]
    т.е.
    \[m^*(\mr{a,b})\le m(\mr{a,b}),\tag{8'}\]
    поскольку $\{ \mr{a,b}_\delta\}\in U(\mr{a,b})$.

    Полагаем $m(\mr{a,b})>0$, иначе $m^*(\mr{a,b})=m(\mr{a,b})=0$.
    Пусть
    \[\delta< \min_{1\le j\le m} \left(\frac{1}{2}(b_j-a_j) \right),\]
    положим
    \[_\delta\mr{a,b}\coloneq\{x:x_j\in[a_j+\delta, b_j-\delta]\}.\]
    Тогда $_\delta\mr{a,b}$~--- компакт, для $\forall\,\epsilon>0\ \exists\delta>0$ т.ч. $m({}_\delta\mr{a,b})>m(\mr{a,b})-\epsilon$.
    %TODO: \forall \epsilon ???
    Пусть $\{A_j\}_{j=1}^\infty\in U(\mr{a,b})$, тогда $\{A_j\}_{j=1}^\infty\in U({}_\delta\mr{a,b})$.
    Поскольку $A_j$ открыто, то можно по лемме Бореля выбрать $A_{j_1},\dotsc,A_{j_l}$, т.ч. ${}_\delta\mr{a,b}\subset \bigcup_{k=1}^l A_{j_k}$, поэтому по аддитивности $m$ на $\mathcal{E}$
    \begin{gather*}
        m(_\delta\mr{a,b})\le m \left(\bigcup_{k=1}^l A_{j_k} \right) \tag{7}\\
        m \left(\bigcup_{k=1}^l A_{j_k} \right)\le\sum_{k=1}^l m\,A_{j_k}\tag{8}
    \end{gather*}

    Считая, что $\{A_j\}^\infty_{j=1}\in U(\mr{a,b})$ такое, что
    \[ \sum_{j=1}^{\infty} m\,A_j<m^*(\mr{a,b})+\epsilon\tag{9} \]
    Теперь (7)--(9) $\implies$
    \begin{multline*}
        m(\mr{a,b})-\epsilon<\\
        <m({}_\delta\mr{a,b})\le\sum_{k=1}^l m\,A_{j_k}\le\sum_{j=1}^{\infty}m\,A_j<\\
        <m^*(\mr{a,b})+\epsilon\tag{10}
    \end{multline*}
    $(10)\implies m(\mr{a,b})\le m^*(\mr{a,b})$, что вместе с предыдущим неравенством (8') доказывает теорему.
\end{longProof}

\section{Множества, измеримые по Лебегу}\marginpar{27.04.23}
\begin{definition}
    Симметрической разностью множеств $A$ и $B$ будем называть
    \[A \symd B = (A \setminus B) \cup (B \setminus A)\]
\end{definition}
Свойства симметрической разности для любых множеств (соотношение (1)):
\begin{enumerate}
    \item $A \symd B \subset (A \symd C) \cup (C \symd B)$
    \item $(A_1 \cup A_2) \symd (B_1 \cup B_2) \subset (A_1 \symd B_1) \cup (A_2 \symd B_2)$
    \item $(A_1 \cap A_2) \symd (B_1 \cap B_2) \subset (A_1 \symd B_1) \cup (A_2 \symd B_2)$
    \item $(A_1 \setminus A_2) \symd (B_1 \setminus B_2) \subset (A_1 \symd B_1) \cup (A_2 \symd B_2)$
\end{enumerate}

Теперь будем работать в $\R^m$, где $m \ge 1$.
Пусть
\[d(A, B) = m^*(A \symd B) \tag{2}\]
Тогда (1) и (2) влекут (соотношение (3))
\begin{enumerate}
    \item $d(A, B) = d(B, A)$
    \item $d(A, B) \le d(A, C) + d(C, B)$
    \item $d(A_1 \cup A_2, B_1 \cup B_2) \le d(A_1, B_1) + d(A_2, B_2)$
    \item $d(A_1 \cap A_2, B_1 \cap B_2) \le d(A_1, B_1) + d(A_2, B_2)$
    \item $d(A_1 \setminus A_2, B_1 \setminus B_2) \le d(A_1, B_1) + d(A_2, B_2)$
\end{enumerate}

\begin{definition}
    Множество $A \subset \R^m$ называется конечно измеримым, если $\exists \{A_n\}_{n=1}^\infty$, где $A_n \in \mathcal{E}$, т.ч.
    \[d(A_n, A) \xrightarrow[n \to \infty]{} 0 \tag{4}\]
\end{definition}
\begin{definition}
    Пусть имеются множества $A_n, A \subset \R^m$, будем говорить, что $A_n \to A$, если
    \[d(A_n, A) \xrightarrow[n \to \infty]{} 0 \tag{5}\]
\end{definition}
\begin{remark}
    В терминах (5), определение конечно измеримого множества можно записать как, $\exists \{A_n\}_{n=1}^\infty$, т.ч $A_n \to A$.
\end{remark}
\begin{definition}
    Множество всех конечно измеримых множеств будем обозначать $\M_F$.
\end{definition}
\begin{remark}
    $\varnothing \in \M_F$.
\end{remark}
\begin{definition}
    Множество $B$ называется измеримым по Лебегу, если $B = \bigcup_{n=1}^\infty B_n$, где $B_n \in \M_F$.
\end{definition}
\begin{definition}
    Множество всех множеств, измеримых по Лебегу, будем обозначать $\M$.
\end{definition}

\begin{lemma}
    Имеем множества $A, B \subset \R^m$, тогда
    \[|m^*A - m^*B| \le d(A, B) \tag{6}\]
\end{lemma}
\begin{proof}
    Будем считать, что $m^* A \le m^*B$.
    Будем полагать, что обе внешние меры конечны.
    Тогда $m^*B = d(B, \varnothing)$, применив (2) получим
    \[m^*B = d(B, \varnothing) \le d(B, A) + d(A, \varnothing) = d(A, B) + m^*A\]
    Откуда и следует (6).
\end{proof}
Из (6) можно сделать вывод, что
\[m^*B \le m^*A + d(A, B) \tag{7}\]

\begin{theorem}
    $\M_F$ является кольцом и внешняя мера является аддитивной функцией на этом кольце.
\end{theorem}
\begin{longProof}
    Пусть $A, B \in \M_F$, тогда $\exists \{A_n\}_{n=1}^\infty, \{B_n\}_{n=1}^\infty$, т.ч. $A_n \to A$, $B_n \to B$ и $A_n, B_n \in \mathcal{E}$.

    Из (3) следует, что
    \[d(A_n \cup B_n, A \cup B) \le d(A_n, A) + d(B_n, B) \xrightarrow[n \to \infty]{} 0\]
    отсюда получаем, что
    \[A_n \cup B_n \to A \cup B. \tag{8}\]
    При этом $A_n \cup B_n \in \mathcal{E}$ и (8) влечет, что $A \cup B \in \M_F$.

    Аналогично для пересечения выпишем нужное нам соотношение
    \[A_n \cap B_n \to A \cap B. \tag{8'}\]

    $A_n \setminus B_n \in \mathcal{E}$, тогда (3) влечет, что
    \[d(A_n \setminus B_n, A \setminus B) \le d(A_n, A) + d(B_n, B) \xrightarrow[n \to \infty]{} 0 \tag{9}\]
    (9) означает, что $A_n \setminus B_n \to A \setminus B$, из этого следует, что $A \setminus B \in \M_F$.

    Проверили, что $\M_F$~--- кольцо, и, кроме того, $\mathcal{E} \subset \M_F$.

    Лемма выше влечет для любых множеств, что если $A_n \to A$, то
    \[m^*A_n \xrightarrow[n \to \infty]{} m^*A. \tag{10'}\]

    Пусть $A$ и $B$ как написаны в самом начале.
    В прошлой лекции было доказано соотношение
    \[mA_n + mB_n = m(A_n \cup B_n) + m(A_n \cap B_n)\]
    и свойство, что мера элементарного множества равна его внешней мере, поэтому
    \[m^*A_n + m^*B_n = m^*(A_n \cup B_n) + m^*(A_n \cap B_n) \tag{10}\]
    Тогда (8), (8') и (10) влекут, что
    \[\begin{gathered}
            m^*A_n \to m^*A \\
            m^*B_n \to M^*B \\
            m^*(A_n \cup B_n) \to m^*(A \cup B) \\
            m^*(A_n \cap B_n) \to m^*(A \cap B)
        \end{gathered} \tag{11}\]
    и (10), (11) влекут
    \[m^*A + m^*B = m^*(A \cup B) + m^*(A \cap B) \tag{12}\]
    (12) действует для любых конечно измеримых $A$ и $B$.
    В частности, если $A \cap B = \varnothing$, тогда (12) влечет
    \[m^*A + m^*B = m^*(A \cup B) \tag{13}\]
    Аддитивность доказана.
\end{longProof}
\begin{remark}
    Пусть $A$~--- конечно измеримое множество.
    Тогда $\exists N$, т.ч. $\forall n > N$ и $\exists A_n$, т.ч. $d(A_n, A) < 1$.

    В частности, $d(A_{N+1}, A) < 1$ и из этого следует, что
    \[m^*A \le m^*A_{N+1} + d(A_{N+1}, A) < m^*A_{N+1} +1 < \infty.\]
\end{remark}

\begin{theorem}
    Пусть $A \in \M$ и $m^*A < \infty$, тогда $A \in \M_F$.
\end{theorem}
\begin{longProof}
    Поскольку $A$ измеримое множество, поэтому
    \[A = \bigcup_{n=1}^\infty A'_n,\]
    где $A_n'$ являются конечно измеримыми.

    Введем новые множества, т.ч. $A_1 = A'_1$, $A_2 = A'_2 \setminus A_1$, \dots, $A_n = A'_n \setminus \left(\bigcup_{k=1}^{n-1} A_k\right)$.
    Из этих определений следует, что
    \[\bigcup_{k=1}^n A'_k = \bigcup_{k=1}^n A_k\]
    и
    \[A = \bigcup_{n=1}^\infty A_n, \tag{15}\]
    кроме того,
    \[A_k \cap A_l = \varnothing, \text{ если } k \neq l. \tag{16}\]
    При таком построении получаем, что $A_n \in \M_F$.

    Введем обозначения $B_n$ и $C_n$:
    \begin{gather*}
        B_n = \bigcup_{k=1}^n A_k \\
        C_n = \bigcup_{k=n+1}^\infty A_k
    \end{gather*}
    В таком случае
    \[A = B_n \cup C_n\]
    Поскольку $B_n \subset A$, то
    \[m^* B_n \le m^* A. \tag{17}\]
    Уже доказано, что для конечно измеримых функций внешняя мера является аддитивной функцией, поэтому
    \[m^*B_n = \sum_{k=1}^{n} m^*A_k \tag{18}\]
    (17) и (18) влекут, что
    \[\sum_{k=1}^{n} m^* A_k \le m^* A \tag{19}\]
    (19) выполнено для любого $n$, кроме того все слагаемые неотрицательные, поэтому (19) влечет
    \[\sum_{k=1}^{\infty} m^*A_k \le m^* A \tag{20}\]
    И теперь (15) влечет, что
    \[m^* A \le \sum_{k=1}^{\infty} m^* A \tag{21}\]
    (20), (21) влекут, что
    \[m^* A = \sum_{k=1}^{\infty} m^* A \tag{22}\]

    Если будем рассматривать $C_n \in \M$~(23') то
    \[m^* C_m \le m^* A < \infty\tag{23}\]
    (22), (23'), (23) влекут, что
    \[m^* C_n = \sum_{k=n+1}^{\infty} m^* A_k \tag{24}\]

    Вернемся к (22), ряд из неотрицательных слагаемых сходится.
    Выберем $\forall \epsilon >0$, тогда (22) влечет, что $\exists N$, т.ч.
    \[\sum_{n=N+1}^{\infty} m^*A_n < \epsilon \tag{25}\]
    (24), (25) влекут
    \[m^* C_{N+1} < \epsilon \tag{26}\]
    (15), (16) влекут, что
    \[A \symd B_n = C_n \tag{27}\]
    тогда (26), (27) влекут
    \[d(B_N, A) = m^* C_N < \epsilon \tag{28}\]
    Вспомним, что
    \[B_N = \bigcup_{k=1}^N A_k\]
    $A_k$~--- конечно измеримое множество, поэтому $\forall k = 1,\dotsc, N$ $\exists \widetilde{A}_k \in \mathcal{E}$, т.ч.
    \[d(\widetilde{A}_k, A_k) < \frac{\epsilon}{N} \tag{29}\]
    Положим
    \[\widetilde{B}_N = \bigcup_{k=1}^N \widetilde{A}_k \tag{30}\]
    и $\widetilde{B}_N$~(31).
    (3), (29) влекут, что
    \[d(\widetilde{B}_N, B_N) \le \sum_{k=1}^{N} d(\widetilde{A}_k, A_k) < N \cdot \frac{\epsilon}{N} = \epsilon \tag{32}\]
    (3), (26), (32) влекут, что
    \[d(\widetilde{B}_N, A) \le d(\widetilde{B}_N, B_N) + d(B_N, A) < \epsilon + \epsilon = 2\epsilon \tag{33}\]
    (31), (33) в силу произвольности $\epsilon$ доказывает, что $A \in \M_F$.
\end{longProof}

\begin{theorem}
    $\M$ является $\sigma$-кольцом, а $m^*$ на этом множестве является счётно-аддитивной функцией.
\end{theorem}
\begin{longProof}
    Пусть имеется $A \in \M$, а так же $A_n \in \M$, такие что $A_n \cap A_k = \varnothing$, если $n \neq k$~(1').
    Предположим, что
    \[A = \bigcup_{n=1}^\infty A_n. \tag{1}\]
    Будем рассматривать ряд, в котором все слагаемые неотрицательные
    \[\sum_{n=1}^{\infty} m^* A_n\]
    Если $\exists n_0$, т.ч. $m^* A_{n_0} = +\infty$, и т.к. $A_{n_0} \subset A$, то $m^* A = +\infty$.
    Теперь будем считать, что
    \[m^* A_n < +\infty\ \forall n. \tag{2}\]
    В таком случае, (2) влечет, что
    \[A_n \in \M_F \tag{3}\]
    Пусть $m^* A = +\infty$~(4'), тогда из неравенства
    \[m^* A \le \sum_{n=1}^{\infty} m^* A_n\]
    следует, что
    \[\sum_{n=1}^{\infty} m^* A_n = +\infty \tag{4}\]
    Если $m^* A < +\infty$, то мы находимся в условиях предыдущей теоремы, и поэтому $A \in \M_F$ и
    \[m^* A = \sum_{n=1}^{\infty} m^* A_n\]
    Доказали счётно-аддитивность внешней меры доказана.

    Докажем, что это $\sigma$-кольцо.
    Имеются множества $A$ и $B$, т.ч. $A = \bigcup_{n=1}^\infty A_n$ и $B = \bigcup_{n=1}^\infty B_n$, где $A_n \in \M_F$ и $B_n \in \M_F$.
    Поэтому
    \[A \cup B = \bigcup_{n=1}^\infty (A_n \cup B_n)\]
    Так же имеются множества $C_n = \bigcup_{k=1}^\infty D_{n_k}$, где $D_{n_k} \in \M_F$, т.е. $C_n \in \M$.
    Тогда
    \[\bigcup_{n=1}^\infty C_n = \bigcup_{n=1}^\infty \bigcup_{k=1}^\infty D_{n_k},\]
    т.к. нумерация по $n$ и $k$ тоже счетная, то $\bigcup_{n=1}^\infty C_n \in \M$.
    Будем считать, что $A_n$ попарно дизъюнктны и $B_n$ тоже попарно дизъюнктны, тогда
    \begin{gather*}
        A \cap B = \bigcup_{n=1}^\infty (A_n \cap B) \tag{5} \\
        A_n \cap B = \bigcup_{k=1}^\infty (A_n \cap B_k) \tag{6} \\
        A_n \cap B_k \in \M_F \tag{7}
    \end{gather*}
    В таком случае (6), (7) влекут, что $A_n \cap B \in \M$~(8).
    Далее
    \[m^* (A_n \cap B) \le m^* A_n < +\infty \tag{9}\]
    (8) и (9) влекут, что $A_n \cap B \in \M_F$~(10).
    А (5) и (10) влекут, что $A \cap B \in \M$.
    Теперь посмотрим на разность:
    \[A \setminus B = \bigcup_{n=1}^\infty (A_n \setminus B) = \bigcup_{n=1}^\infty (A_n \setminus (A_n \cap B)),\]
    т.к. $A_n \in \M_F$ и $A_n \cap B \in \M_F$, значит и $(A_n \setminus (A_n \cap B)) \in \M_F$, и $A \setminus B \in \M$.
\end{longProof}

\begin{definition}[мера Лебега]
    Если $A \in \M$, то
    \[m A \coloneq m^* A.\]
\end{definition}

\subsection{Примеры множеств, измеримых по Лебегу}
\marginpar{04.05.23}
\begin{enumerate}
    \item Если $A \in \mathcal{E}$, то $A \in \M_F$
    \item $\R^n \in \M$

          Рассмотрим множества
          \[U_k = \underbrace{[-k, k] \times \dotsb \times [-k, k]}_{n} \in \M,\]
          тогда $\R^n = \bigcup_{k \ge 1} U_k$
    \item Если множество $B$~--- открыто и $B \neq \R^n$, тогда $B \in \M$

          Рассмотрим множество всех точек с рациональными координатами:
          \[\underbrace{\Q \times \Q \times \dotsb \times \Q}_n \cap B = E,\]
          Для любой точки $a \in E$, где $a = (a_1, \dotsc, a_n)$, и для $\delta >0$, обозначим множество
          \[Q_\delta(a) = \{x = (x_1, \dotsc, x_n):  a_k - \delta < x_k < a_k + \delta, 1 \le k \le n\}\]
          Обозначим $Q_\delta^*$ такие кубы, что $Q^*_\delta \subset B$, но $\overline{Q^*_\delta} \not \subset B$, тогда $B = \bigcup_{a \in E} Q_\delta^* \in \M$, т.к. $Q_\delta^*(a) \in \M$
    \item Пусть $F$~--- замкнутое множество, тогда $F \in \M$

          Пусть $B = \R^n \setminus F$, тогда $B$~--- открытое множество и $B \in \M$, но $F = \R^n \setminus B$.
\end{enumerate}

\section{Измеримые функции}
Далее считаем, что $n \ge 1$.
\begin{definition}
    Пусть имеется $E \subset \R^n$ и $E \in \M$.
    И задана функция $f: E \to \overline{\R}$, где $\overline{\R} = \R \cup \{+\infty\} \cup \{-\infty\}$.
    Пусть $a \in \R$, тогда множествами Лебега называются следующие 4 множества:
    \begin{gather*}
        E_{> a}(f) = \{x \in E: f(x) > a\} \\
        E_{\ge a}(f) = \{x \in E: f(x) \ge a\} \\
        E_{< a}(f) = \{x \in E: f(x) < a\} \\
        E_{\le a}(f) = \{x \in E: f(x) \le a\}
    \end{gather*}
    Функция $f$ называется измеримой, если $\forall a \in \R$ все четыре множества являются измеримыми.
\end{definition}

\begin{theorem}
    Для того, чтобы функция была измеримой, необходимо и достаточно при любом $a \in \R$ было бы измеримо любое из четырех множеств.
\end{theorem}
\begin{proof}
    Необходимость следует из определения.

    Достаточность.
    Пусть одно из них измеримо.
    Доказательство следует из тождеств теории множеств:
    \[\begin{aligned}
            E_{\ge a}(f) & = \bigcap_{m=1}^\infty E_{> a - \frac{1}{m}} \\
            E_{< a}(f)   & = E \setminus E_{\ge a}                      \\
            E_{\le a}(f) & = \bigcap_{m=1}^\infty E_{< a + \frac{1}{m}} \\
            E_{> a}(f)   & = E \setminus E_{\le a}
        \end{aligned} \tag{1}\]
    Примем их без доказательства.

    Если $E_{>a}$ измеримо, то и $E_{\ge a}$ измеримо, тогда $E_{< a}$ измеримо, и, соответственно, $E_{\le a}$ тоже измеримо.
    Остальные проверяются аналогично.
\end{proof}

\subsection{Первые свойства измеримых функций}
Считаем, что множество $E \subset \R^n$ всегда задано.

\begin{property}
    Пусть имеется $F \subset E$, через $K_F(x)$ обозначим характеристическую функцию множества $F$ на множестве $E$:
    \[K_F(x) = \begin{cases}
            1, & x \in F             \\
            0, & x \in E \setminus F
        \end{cases}\]
    Такая функция измерима.
\end{property}

\begin{property}
    Пусть $f$ измерима, $c > 0$, тогда $cf$ измерима.
\end{property}
\begin{proof}
    Следует из $E_{> ca} (cf) = E_{>a} (f)$.
\end{proof}

\begin{property}
    Пусть $f$ измерима, тогда $-f$ измерима.
\end{property}
\begin{proof}
    Следует из $E_{>a}(f) = E_{< -a} (f)$.
\end{proof}

\begin{property}
    Пусть $f$ измерима, $c \neq 0$, тогда $cf$ измерима.
\end{property}
\begin{proof}
    Следует из свойств выше.
\end{proof}

\begin{property}
    Пусть $f$ измерима, тогда $0 \cdot f$ измерима.
\end{property}

\begin{remark}
    Считаем выполненными следующие равенства:
    \begin{gather*}
        0 \cdot(+\infty) = 0\\
        0 \cdot(-\infty) = 0
    \end{gather*}
\end{remark}

\begin{property}
    Пусть имеется функциональная последовательность $\{f_m(x)\}_{m=1}^\infty$, где $f_m$~--- измерима, и $f_m: E \to \overline{\R}$.
    Пусть
    \begin{gather*}
        g_{+}(x) = \sup_{m} f_m(x) \\
        g_{-}(x) = \inf_{m} f_m(x),
    \end{gather*}
    тогда $g_+$ и $g_-$ измеримы.
\end{property}
\begin{proof}
    Следует из тождеств:
    \[\begin{aligned}
            E_{>a} (g_+) & = \bigcup_{m=1}^\infty E_{>a}(f_m) \\
            E_{>a} (g_-) & = \bigcup_{m=1}^\infty E_{<a}(f_m)
        \end{aligned}\tag{2}\]
\end{proof}

\begin{property}
    Имеются $f_m$ как выше, тогда
    \begin{gather*}
        h_+(x) = \varlimsup_{m \to \infty} f_m(x) \\
        h_-(x) = \varliminf_{m \to \infty} f_m(x),
    \end{gather*}
    и $h_+$, $h_-$ измеримы
\end{property}
\begin{proof}
    Докажем только для $h_+$: определим $g_{m+}(x)$
    \[g_{m+} (x) = \sup_{k\ge m} f_k(x),\]
    тогда $g_{m+}$~--- измеримо по предыдущему свойству.

    Кроме того,
    \[h_+(x) = \inf_{m \ge 1} g_{m+}(x), \tag{3}\]
    откуда следует, что $h_+(x)$ измеримо.
\end{proof}

\begin{property}
    Имеются $f_m$ как выше.
    Предположим, что
    \[\forall x\in E\  \exists \lim_{m \to \infty} f_m(x) = F(x),\]
    тогда $F$~--- измеримо.
\end{property}
\begin{proof}
    По свойствам пределов допустим, что
    \[\lim_{m \to \infty} f_m(x) = \varlimsup_{m \to \infty} f_m(x),\]
    и тогда предел измерим по предыдущему свойству.
\end{proof}

\begin{property}
    Пусть $f$~--- измерима, тогда $|f|$ тоже измерим.
\end{property}
\begin{proof}
    Возьмем $a < 0$, то
    \[E_{>a}(|f|) = E,\]
    иначе, если $a \ge 0$, тогда
    \[E_{>a}(|f|) = E_{>a} (f) \cup E_{< -a} (f)\]
\end{proof}

\begin{property}
    Пусть $f, g$~--- измеримы, определим функции
    \begin{gather*}
        U(x) = \max (f(x), g(x)) \\
        V(x) = \min (f(x), g(x)),
    \end{gather*}
    тогда $U, V$ измеримы.
\end{property}
\begin{proof}
    Рассмотрим последовательность, где $f_1 = f$, а $f_2 = f_3 = ... = g$, её $\sup$ будет максимумом, а $\inf$ минимумом.
\end{proof}

\begin{theorem}
    Пусть $F(u,v): \R^2 \to \R$ и $F\in C(\R^2)$, кроме того имеются $f, g: E \to \R$ и $f, g$~--- измеримые.
    Рассмотрим $P(x) = F(f(x), g(x))$, тогда $P$~-- измерима.
\end{theorem}
\begin{proof}
    Примем как факт.
\end{proof}

\begin{example}
    Пусть $F(u, v) = u + v$, если $f, g$ измеримы, то и $f+g$ измерима.
\end{example}
\begin{example}
    Пусть $F(u, v) = uv$, если $f, g$ измеримы, то и $fg$ измерима.
\end{example}

\end{document}
